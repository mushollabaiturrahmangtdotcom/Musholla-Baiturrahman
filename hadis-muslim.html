<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shahih Muslim â€” Musholla Baiturrahman</title>
<link rel="icon" type="image/png" href="images/logo.png">
<link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Tajawal:wght@300;400;500;700&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
:root {
  --deep:   #0e2a40;
  --mid:    #154f74;
  --bright: #1a7aaa;
  --light:  #2196c8;
  --gold:    #c9a84c;
  --goldl:   #e8c97a;
  --cream:   #f8f4ec;
  --creamd:  #eae4d6;
  --white:   #ffffff;
  --ink:     #1c1c1c;
  --inkm:    #444;
  --inkl:    #788;
  --ok:      #16a34a;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Crimson Pro', Georgia, serif;
  background: var(--cream); color: var(--ink);
  min-height: 100vh; display: flex; flex-direction: column;
}
nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 200;
  height: 60px; background: var(--deep); border-bottom: 2px solid var(--gold);
  display: flex; align-items: center; justify-content: space-between; padding: 0 1.5rem;
}
.nav-brand { display: flex; align-items: center; gap: 10px; text-decoration: none; }
.nav-brand img { height: 34px; }
.nav-brand span { font-size: .82rem; font-weight: 600; color: #fff; font-family: 'Tajawal', sans-serif; }
.nav-back { font-family: 'Tajawal', sans-serif; font-size: .78rem; font-weight: 500; color: rgba(255,255,255,.75); text-decoration: none; padding: 5px 13px; border-radius: 6px; border: 1px solid rgba(255,255,255,.2); transition: all .2s; }
.nav-back:hover { background: rgba(255,255,255,.1); color: var(--goldl); }
.hero-header { margin-top: 60px; background: linear-gradient(160deg, var(--deep) 0%, var(--mid) 60%, var(--bright) 100%); padding: 40px 24px 32px; text-align: center; position: relative; overflow: hidden; }
.hero-header::before { content: ''; position: absolute; top: -60px; right: -60px; width: 280px; height: 280px; border: 50px solid rgba(201,168,76,.07); border-radius: 50%; }
.hero-header::after { content: ''; position: absolute; bottom: -40px; left: -40px; width: 200px; height: 200px; border: 35px solid rgba(201,168,76,.05); border-radius: 50%; }
.hero-ar { font-family: 'Amiri', serif; font-size: clamp(2rem,5vw,3.2rem); color: var(--goldl); direction: rtl; line-height: 1.4; margin-bottom: 8px; }
.hero-title { font-family: 'Tajawal', sans-serif; font-size: clamp(1.2rem,3vw,1.8rem); color: rgba(255,255,255,.9); font-weight: 700; margin-bottom: 14px; }
.hero-stats { display: inline-flex; gap: 12px; flex-wrap: wrap; justify-content: center; margin-bottom: 20px; }
.h-stat { background: rgba(201,168,76,.15); border: 1px solid rgba(201,168,76,.3); border-radius: 20px; padding: 5px 14px; font-family: 'Tajawal', sans-serif; font-size: .75rem; color: var(--goldl); font-weight: 600; }
.hero-desc { font-family: 'Tajawal', sans-serif; font-size: .82rem; color: rgba(255,255,255,.55); max-width: 500px; margin: 0 auto; line-height: 1.75; }
.content-wrap { max-width: 900px; margin: 0 auto; padding: 24px 16px 40px; width: 100%; }
.status-bar { display: flex; align-items: center; gap: 8px; padding: 8px 14px; border-radius: 10px; margin-bottom: 14px; font-family: 'Tajawal', sans-serif; font-size: .75rem; font-weight: 500; transition: all .3s; }
.status-bar.loading { background: rgba(201,168,76,.1); border: 1px solid rgba(201,168,76,.25); color: #8a6b1e; }
.status-bar.success { background: rgba(22,163,74,.08); border: 1px solid rgba(22,163,74,.2); color: #166534; }
.status-bar.warning { background: rgba(234,179,8,.08); border: 1px solid rgba(234,179,8,.25); color: #713f12; }
.status-bar.error   { background: rgba(220,38,38,.07); border: 1px solid rgba(220,38,38,.2); color: #991b1b; }
.status-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.status-bar.loading .status-dot { background: #c9a84c; animation: pulse 1s infinite; }
.status-bar.success .status-dot { background: #16a34a; }
.status-bar.warning .status-dot { background: #eab308; }
.status-bar.error   .status-dot { background: #dc2626; }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }
.controls-bar { display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; background: var(--white); border-radius: 14px; padding: 14px 18px; margin-bottom: 20px; border: 1px solid var(--creamd); box-shadow: 0 2px 12px rgba(0,0,0,.04); }
.ctrl-left { font-family: 'Tajawal', sans-serif; font-size: .78rem; color: var(--inkl); }
.ctrl-left strong { color: var(--bright); font-size: .9rem; }
.ctrl-right { display: flex; align-items: center; gap: 8px; }
.nav-arrow { width: 34px; height: 34px; border-radius: 8px; border: 1.5px solid var(--creamd); background: var(--white); font-size: .9rem; cursor: pointer; display: grid; place-items: center; transition: all .15s; color: var(--inkm); }
.nav-arrow:hover:not(:disabled) { background: var(--deep); color: #fff; border-color: var(--deep); }
.nav-arrow:disabled { opacity: .35; cursor: not-allowed; }
.page-counter { font-family: 'Tajawal', sans-serif; font-size: .78rem; color: var(--inkl); padding: 5px 12px; background: var(--cream); border-radius: 8px; border: 1px solid var(--creamd); white-space: nowrap; }
.jump-wrap { display: flex; align-items: center; gap: 6px; font-family: 'Tajawal', sans-serif; font-size: .78rem; color: var(--inkl); }
.jump-wrap input { width: 52px; padding: 5px 8px; text-align: center; border: 1.5px solid var(--creamd); border-radius: 7px; font-family: 'Tajawal', sans-serif; font-size: .82rem; color: var(--deep); background: var(--cream); outline: none; transition: border-color .2s; }
.jump-wrap input:focus { border-color: var(--bright); }
.jump-btn { padding: 5px 11px; border-radius: 7px; background: var(--deep); color: var(--goldl); font-family: 'Tajawal', sans-serif; font-size: .73rem; font-weight: 600; border: none; cursor: pointer; transition: background .15s; }
.jump-btn:hover { background: var(--mid); }
.state-box { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 24px; gap: 16px; text-align: center; }
.spinner { width: 46px; height: 46px; border: 3px solid var(--creamd); border-top-color: var(--bright); border-radius: 50%; animation: spin .8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
.state-body { font-family: 'Tajawal', sans-serif; font-size: .85rem; color: var(--inkl); line-height: 1.75; max-width: 380px; }
.err-box { background: #fff5f5; border: 1px solid #fecaca; border-radius: 12px; padding: 20px 24px; max-width: 480px; width: 100%; text-align: left; }
.err-box p { font-family: 'Tajawal', sans-serif; font-size: .84rem; color: #b91c1c; line-height: 1.75; }
.err-box code { display: block; margin-top: 8px; font-size: .7rem; color: #999; background: #f5f5f5; padding: 6px 10px; border-radius: 6px; word-break: break-all; }
.err-servers { margin-top: 12px; display: flex; flex-direction: column; gap: 5px; }
.srv-row { display: flex; align-items: center; gap: 7px; font-family: 'Tajawal', sans-serif; font-size: .73rem; }
.srv-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.srv-ok   .srv-dot { background: #16a34a; } .srv-ok   { color: #166534; }
.srv-fail .srv-dot { background: #dc2626; } .srv-fail { color: #991b1b; }
.srv-wait .srv-dot { background: #d1d5db; } .srv-wait { color: #9ca3af; }
.btn-retry { margin-top: 14px; padding: 9px 24px; border-radius: 8px; background: var(--deep); color: #fff; font-family: 'Tajawal', sans-serif; font-size: .82rem; font-weight: 600; border: none; cursor: pointer; transition: background .15s; }
.btn-retry:hover { background: var(--mid); }
.hadis-list { display: flex; flex-direction: column; gap: 14px; }
.hadis-card { background: var(--white); border-radius: 16px; border: 1px solid var(--creamd); overflow: hidden; transition: box-shadow .2s, transform .2s; }
.hadis-card:hover { box-shadow: 0 8px 28px rgba(13,59,46,.09); transform: translateY(-1px); }
.hc-top { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: linear-gradient(90deg, rgba(13,59,46,.04), transparent); border-bottom: 1px solid var(--creamd); }
.hc-badge { display: flex; align-items: center; gap: 10px; }
.hc-num { width: 36px; height: 36px; flex-shrink: 0; background: linear-gradient(135deg, var(--deep), var(--mid)); border-radius: 10px; display: grid; place-items: center; font-family: 'Tajawal', sans-serif; font-size: .72rem; font-weight: 700; color: var(--goldl); }
.hc-meta { font-family: 'Tajawal', sans-serif; font-size: .72rem; color: var(--inkl); line-height: 1.5; }
.hc-meta b { color: var(--bright); font-weight: 600; }
.hc-src { display: inline-block; margin-left: 6px; padding: 1px 7px; border-radius: 10px; font-size: .6rem; font-weight: 700; letter-spacing: .04em; vertical-align: middle; }
.hc-src.src-id  { background: rgba(22,163,74,.1); color: #15803d; }
.hc-src.src-cdn { background: rgba(234,179,8,.12); color: #854d0e; }
.hc-actions { display: flex; gap: 6px; }
.hc-action { width: 30px; height: 30px; border-radius: 8px; border: 1px solid var(--creamd); background: var(--white); cursor: pointer; display: grid; place-items: center; font-size: .8rem; transition: all .15s; color: var(--inkl); }
.hc-action:hover { border-color: var(--bright); color: var(--bright); }
.hc-action.copied { border-color: var(--ok); color: var(--ok); background: rgba(22,163,74,.06); }
.hc-arab { font-family: 'Amiri', serif; font-size: 1.55rem; line-height: 2.4; direction: rtl; text-align: right; color: var(--ink); padding: 20px 22px 16px; background: linear-gradient(160deg, rgba(201,168,76,.05) 0%, transparent 60%); border-bottom: 1px solid var(--creamd); position: relative; }
.hc-arab::before { content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 4px; background: linear-gradient(180deg, var(--gold), var(--goldl)); }
.hc-sep { display: flex; align-items: center; gap: 10px; padding: 0 16px; }
.hc-sep-line { flex: 1; height: 1px; background: var(--creamd); }
.hc-sep-label { font-family: 'Tajawal', sans-serif; font-size: .6rem; font-weight: 700; letter-spacing: .1em; text-transform: uppercase; color: var(--inkl); padding: 4px 0; }
.hc-terjemah { font-family: 'Crimson Pro', serif; font-size: 1.05rem; line-height: 1.9; color: var(--inkm); padding: 12px 20px 18px; border-left: 3px solid var(--light); margin: 8px 16px 14px; border-radius: 0 8px 8px 0; background: rgba(39,174,116,.04); }
.no-translate { font-style: italic; color: var(--inkl); font-size: .9rem; }
.pagination { display: flex; align-items: center; justify-content: center; gap: 5px; padding: 24px 0 0; flex-wrap: wrap; }
.pg-btn { min-width: 36px; height: 36px; padding: 0 8px; border-radius: 9px; border: 1.5px solid var(--creamd); background: var(--white); font-family: 'Tajawal', sans-serif; font-size: .82rem; font-weight: 600; color: var(--deep); cursor: pointer; transition: all .18s; display: grid; place-items: center; }
.pg-btn:hover:not(:disabled):not(.dots) { background: var(--deep); color: var(--goldl); border-color: var(--deep); }
.pg-btn.active { background: var(--deep); color: var(--goldl); border-color: var(--deep); }
.pg-btn:disabled { opacity: .3; cursor: not-allowed; }
.pg-btn.dots { border-color: transparent; background: transparent; cursor: default; color: var(--inkl); }
@media (max-width: 620px) {
  nav .nav-brand span { display: none; }
  .hero-header { padding: 28px 16px 24px; }
  .hc-arab { font-size: 1.3rem; }
  .controls-bar { flex-direction: column; align-items: flex-start; }
  .ctrl-right { width: 100%; justify-content: flex-end; }
}
</style>
</head>
<body>

<nav>
  <a href="index.html" class="nav-brand">
    <img src="images/logo_nav.png" alt="Logo">
    <span>Musholla Baiturrahman</span>
  </a>
  <a href="index.html" class="nav-back">â† Kembali</a>
</nav>

<div class="hero-header">
  <div class="hero-ar">ØµÙØ­ÙÙŠØ­Ù Ù…ÙØ³Ù’Ù„ÙÙ…</div>
  <div class="hero-title">Shahih Muslim</div>
  <div class="hero-stats">
    <span class="h-stat">ğŸ“š 7.453 Hadis</span>
    <span class="h-stat">ğŸ“– Terjemahan Indonesia</span>
    <span class="h-stat">âœ… Shahih</span>
  </div>
  <p class="hero-desc">Kitab hadis terpercaya karya Imam Muslim bin Al-Hajjaj Al-Qusyairi An-Naisaburi rahimahullah. Beliau mengumpulkan lebih dari 300.000 hadis lalu memilih 7.453 hadis yang paling shahih.</p>
</div>

<div class="content-wrap">
  <div id="statusBar" class="status-bar loading">
    <div class="status-dot"></div>
    <span id="statusText">Menghubungi server...</span>
  </div>

  <div class="controls-bar" id="controlsBar" style="display:none">
    <div class="ctrl-left">Hadis <strong id="rangeInfo">â€“</strong> dari <strong id="totalInfo">â€“</strong></div>
    <div class="ctrl-right">
      <div class="jump-wrap">
        Hal. <input type="number" id="jumpInput" min="1" placeholder="1">
        <button class="jump-btn" onclick="jumpToPage()">Go</button>
      </div>
      <button class="nav-arrow" id="btnPrev" onclick="pindahHal(curPage-1)" disabled>â€¹</button>
      <span class="page-counter" id="pageCounter">â€“ / â€“</span>
      <button class="nav-arrow" id="btnNext" onclick="pindahHal(curPage+1)" disabled>â€º</button>
    </div>
  </div>

  <div id="contentArea">
    <div class="state-box">
      <div class="spinner"></div>
      <div class="state-body">Memuat hadis, mohon tunggu...<br><small style="font-size:.72rem">Mencoba 3 server secara otomatis</small></div>
    </div>
  </div>
  <div id="paginationBottom"></div>
</div>

<script>
(function(){
'use strict';

var CFG = {
  kitab:    'muslim',
  cdnArab:  'ara-muslim',
  cdnEng:   'eng-muslim',
  total:    7453,
  limit:    10,
  label:    'Shahih Muslim',
  labelNo:  'Muslim'
};

var SERVERS = [
  {id:1, name:'Server 1 â€” gading.dev (Indonesia)',   status:'wait'},
  {id:2, name:'Server 2 â€” vercel.app (Indonesia)',   status:'wait'},
  {id:3, name:'Server 3 â€” jsDelivr CDN (Arab+Ingg)', status:'wait'}
];

var curPage    = 1;
var totalItems = CFG.total;
var totalPages = Math.ceil(CFG.total / CFG.limit);
var CACHE      = {};
var activeSrv  = 0;

/* â”€â”€ Status bar â”€â”€ */
function setStatus(type, msg){
  var b = document.getElementById('statusBar');
  b.className = 'status-bar ' + type;
  document.getElementById('statusText').textContent = msg;
}

/* â”€â”€ Fetch dengan timeout â”€â”€ */
function fetchT(url, ms){
  return new Promise(function(resolve, reject){
    var t = setTimeout(function(){ reject(new Error('Timeout')); }, ms || 9000);
    fetch(url).then(function(r){
      clearTimeout(t);
      r.ok ? resolve(r) : reject(new Error('HTTP '+r.status));
    }).catch(function(e){ clearTimeout(t); reject(e); });
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN ENTRY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function muatHalaman(page){
  if(page < 1 || page > totalPages) return;
  curPage = page;
  var key = 'p'+page;
  if(CACHE[key]){ renderHadis(CACHE[key]); window.scrollTo({top:0,behavior:'smooth'}); return; }
  tampilLoading();
  if(activeSrv === 1){ coba1(page); return; }
  if(activeSrv === 2){ coba2(page); return; }
  if(activeSrv === 3){ coba3(page); return; }
  coba1(page);
}

/* â”€â”€ SERVER 1: api.hadith.gading.dev â”€â”€ */
function coba1(page){
  SERVERS[0].status = 'loading';
  setStatus('loading','â³ Mencoba Server 1 (gading.dev)...');
  var s = (page-1)*CFG.limit + 1;
  var e = Math.min(page*CFG.limit, CFG.total);
  fetchT('https://api.hadith.gading.dev/books/'+CFG.kitab+'?range='+s+'-'+e)
    .then(function(r){ return r.json(); })
    .then(function(res){
      var h = parseGading(res, s);
      if(!h.length) throw new Error('empty');
      SERVERS[0].status = 'ok'; activeSrv = 1;
      setStatus('success','âœ… Server 1 aktif (gading.dev) â€” Terjemahan Indonesia');
      simpan(page, h, 'id');
    })
    .catch(function(){ SERVERS[0].status='fail'; coba2(page); });
}

/* â”€â”€ SERVER 2: hadis-api-id.vercel.app â”€â”€ */
function coba2(page){
  SERVERS[1].status = 'loading';
  setStatus('warning','âš ï¸ Server 1 gagal â€” Mencoba Server 2 (vercel)...');
  fetchT('https://hadis-api-id.vercel.app/hadith/'+CFG.kitab+'?page='+page+'&limit='+CFG.limit)
    .then(function(r){ return r.json(); })
    .then(function(res){
      var h = parseVercel(res);
      if(!h.length) throw new Error('empty');
      var pg = (res.data&&res.data.pagination)||(res.pagination)||{};
      if(pg.totalItems){ totalItems=pg.totalItems; totalPages=Math.ceil(totalItems/CFG.limit); }
      SERVERS[1].status = 'ok'; activeSrv = 2;
      setStatus('success','âœ… Server 2 aktif (vercel) â€” Terjemahan Indonesia');
      simpan(page, h, 'id');
    })
    .catch(function(){ SERVERS[1].status='fail'; coba3(page); });
}

/* â”€â”€ SERVER 3: jsDelivr CDN fawazahmed0 (fetch per-nomor, parallel) â”€â”€ */
function coba3(page){
  SERVERS[2].status = 'loading';
  setStatus('warning','âš ï¸ Server 1 & 2 gagal â€” Mencoba Server 3 (jsDelivr CDN)...');
  var s    = (page-1)*CFG.limit + 1;
  var e    = Math.min(page*CFG.limit, CFG.total);
  var BASE = 'https://cdn.jsdelivr.net/gh/fawazahmed0/hadith-api@1/editions/';
  var jobs = [];
  for(var n=s; n<=e; n++){
    (function(num){
      var ar = fetchT(BASE+CFG.cdnArab+'/'+num+'.min.json',12000).then(function(r){return r.json();}).catch(function(){return null;});
      var en = fetchT(BASE+CFG.cdnEng +'/'+num+'.min.json',12000).then(function(r){return r.json();}).catch(function(){return null;});
      jobs.push(Promise.all([ar,en]).then(function(v){ return {num:num,ar:v[0],en:v[1]}; }));
    })(n);
  }
  Promise.all(jobs).then(function(results){
    var h = results.map(function(r){
      var arab = '', trjm = '';
      if(r.ar&&r.ar.hadiths&&r.ar.hadiths[0]) arab = (r.ar.hadiths[0].text||'').trim();
      if(r.en&&r.en.hadiths&&r.en.hadiths[0]) trjm = (r.en.hadiths[0].text||'').trim();
      return {number:r.num, arab:arab, terjemah:trjm};
    }).filter(function(h){ return h.arab||h.terjemah; });
    if(!h.length) throw new Error('Semua server tidak merespons');
    SERVERS[2].status = 'ok'; activeSrv = 3;
    setStatus('warning','âš¡ Server 3 (CDN) aktif â€” Bahasa Arab + Inggris');
    simpan(page, h, 'cdn');
  }).catch(function(e){
    SERVERS[2].status = 'fail'; activeSrv = 0;
    tampilError(e);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PARSER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function parseGading(res, start){
  var raw = [];
  if(res.data&&Array.isArray(res.data.hadiths)) raw=res.data.hadiths;
  else if(res.data&&Array.isArray(res.data))    raw=res.data;
  else if(Array.isArray(res.hadiths))           raw=res.hadiths;
  return raw.map(function(h,i){
    var arab = (h.arab||h.arabic||'').trim();
    var trjm = '';
    if(h.id&&typeof h.id==='string'&&h.id.length>20) trjm=h.id;
    trjm = trjm||h.indonesia||h.terjemah||h.translation||'';
    return {number:h.number||(start+i), arab:arab, terjemah:trjm.trim()};
  }).filter(function(h){ return h.arab||h.terjemah; });
}

function parseVercel(res){
  var raw = [];
  if(res.data&&Array.isArray(res.data.hadiths)) raw=res.data.hadiths;
  else if(res.data&&Array.isArray(res.data))    raw=res.data;
  else if(Array.isArray(res.hadiths))           raw=res.hadiths;
  return raw.map(function(h){
    var arab = (h.arab||h.arabic||'').trim();
    var trjm = (h.id&&typeof h.id==='string'&&h.id.length>20)?h.id:(h.indonesia||h.terjemah||h.translation||'');
    if(trjm===CFG.kitab) trjm='';
    return {number:h.number||h.no, arab:arab, terjemah:trjm.trim()};
  }).filter(function(h){ return h.arab||h.terjemah; });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function simpan(page, hadiths, src){
  CACHE['p'+page] = {hadiths:hadiths, page:page, src:src};
  renderHadis(CACHE['p'+page]);
  window.scrollTo({top:0, behavior:'smooth'});
}

function renderHadis(data){
  var hadiths = data.hadiths||[], page=data.page||curPage, src=data.src||'id';
  var start   = (page-1)*CFG.limit+1;
  var end     = Math.min(page*CFG.limit, totalItems);

  document.getElementById('controlsBar').style.display='flex';
  document.getElementById('rangeInfo').textContent   = start+'â€“'+end;
  document.getElementById('totalInfo').textContent   = totalItems.toLocaleString('id-ID');
  document.getElementById('pageCounter').textContent = page+' / '+totalPages;
  document.getElementById('btnPrev').disabled = page<=1;
  document.getElementById('btnNext').disabled = page>=totalPages;
  document.getElementById('jumpInput').max    = totalPages;

  if(!hadiths.length){
    document.getElementById('contentArea').innerHTML =
      '<div class="state-box"><div style="font-size:2.5rem">ğŸ“­</div>'+
      '<div class="state-body">Tidak ada hadis pada halaman ini. Coba halaman lain.</div></div>';
    return;
  }

  var srcBadge = src==='cdn'
    ? '<span class="hc-src src-cdn">Arab+Ingg</span>'
    : '<span class="hc-src src-id">Indonesia</span>';
  var sepLabel = src==='cdn' ? 'Translation' : 'Terjemahan';

  var html = '<div class="hadis-list">';
  hadiths.forEach(function(h){
    var num=h.number||'', arab=(h.arab||'').trim(), trjm=(h.terjemah||'').trim();
    html +=
      '<div class="hadis-card">'+
        '<div class="hc-top">'+
          '<div class="hc-badge">'+
            '<div class="hc-num">'+num+'</div>'+
            '<div class="hc-meta">'+CFG.label+' Â· No.&nbsp;<b>'+num+'</b>'+srcBadge+'</div>'+
          '</div>'+
          '<div class="hc-actions">'+
            '<button class="hc-action" onclick="salinHadis('+num+',this)" title="Salin">ğŸ“‹</button>'+
          '</div>'+
        '</div>'+
        (arab?'<div class="hc-arab">'+arab+'</div>':'')+
        '<div class="hc-sep"><div class="hc-sep-line"></div><div class="hc-sep-label">'+sepLabel+'</div><div class="hc-sep-line"></div></div>'+
        '<div class="hc-terjemah">'+(trjm||'<span class="no-translate">Terjemahan tidak tersedia untuk hadis ini.</span>')+'</div>'+
      '</div>';
  });
  html += '</div>';
  document.getElementById('contentArea').innerHTML = html;
  document.getElementById('paginationBottom').innerHTML = buildPagination(page, totalPages);
}

function buildPagination(cur, total){
  if(total<=1) return '';
  var pages=[];
  if(total<=7){ for(var i=1;i<=total;i++) pages.push(i); }
  else{
    pages.push(1);
    if(cur>3) pages.push('â€¦');
    var lo=Math.max(2,cur-1), hi=Math.min(total-1,cur+1);
    for(var p=lo;p<=hi;p++) pages.push(p);
    if(cur<total-2) pages.push('â€¦');
    pages.push(total);
  }
  var h='<div class="pagination">'+
    '<button class="pg-btn" onclick="pindahHal(1)" '+(cur<=1?'disabled':'')+'>Â«</button>'+
    '<button class="pg-btn" onclick="pindahHal('+(cur-1)+')" '+(cur<=1?'disabled':'')+'>â€¹</button>';
  pages.forEach(function(p){
    h+=p==='â€¦'?'<button class="pg-btn dots">â€¦</button>':
      '<button class="pg-btn'+(p===cur?' active':'')+'" onclick="pindahHal('+p+')">'+p+'</button>';
  });
  h+='<button class="pg-btn" onclick="pindahHal('+(cur+1)+')" '+(cur>=total?'disabled':'')+'>â€º</button>'+
     '<button class="pg-btn" onclick="pindahHal('+total+')" '+(cur>=total?'disabled':'')+'>Â»</button></div>';
  return h;
}

function tampilLoading(){
  document.getElementById('controlsBar').style.display='none';
  document.getElementById('paginationBottom').innerHTML='';
  document.getElementById('contentArea').innerHTML=
    '<div class="state-box"><div class="spinner"></div>'+
    '<div class="state-body">Memuat halaman '+curPage+'...<br>'+
    '<small style="font-size:.72rem;color:var(--inkl)">Mencoba 3 server secara otomatis</small></div></div>';
}

function tampilError(err){
  document.getElementById('controlsBar').style.display='none';
  setStatus('error','âŒ Semua server gagal. Periksa koneksi internet Anda.');
  var srvHtml = SERVERS.map(function(s){
    var cls = s.status==='ok'?'srv-ok':s.status==='fail'?'srv-fail':'srv-wait';
    var icon = s.status==='ok'?'âœ“':s.status==='fail'?'âœ—':'â€“';
    return '<div class="srv-row '+cls+'"><div class="srv-dot"></div>'+icon+' '+s.name+'</div>';
  }).join('');
  document.getElementById('contentArea').innerHTML=
    '<div class="state-box">'+
      '<div class="err-box">'+
        '<p>âš ï¸ <strong>Semua server (3/3) gagal diakses.</strong><br>'+
        'Pastikan Anda terhubung ke internet, lalu tekan tombol di bawah.</p>'+
        (err?'<code>'+err.message+'</code>':'')+
        '<div class="err-servers">'+srvHtml+'</div>'+
        '<button class="btn-retry" onclick="muatUlang()">ğŸ”„ Coba Lagi</button>'+
      '</div>'+
    '</div>';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PUBLIC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
window.pindahHal = function(page){
  var pg=parseInt(page); if(isNaN(pg)||pg<1||pg>totalPages) return;
  curPage=pg; muatHalaman(pg);
};
window.jumpToPage = function(){
  var v=parseInt(document.getElementById('jumpInput').value);
  if(!isNaN(v)&&v>=1&&v<=totalPages) pindahHal(v);
};
window.muatUlang = function(){
  CACHE={}; activeSrv=0;
  SERVERS.forEach(function(s){ s.status='wait'; });
  muatHalaman(curPage);
};
window.salinHadis = function(num, btn){
  var trjm = btn.closest('.hadis-card').querySelector('.hc-terjemah');
  if(!trjm) return;
  var teks='['+CFG.label+' No. '+num+']\n\n'+trjm.innerText.trim()+'\n\nâ€” Musholla Baiturrahman';
  if(navigator.clipboard) navigator.clipboard.writeText(teks).then(function(){
    btn.textContent='âœ…'; btn.classList.add('copied');
    setTimeout(function(){ btn.textContent='ğŸ“‹'; btn.classList.remove('copied'); },2200);
  });
};

muatHalaman(1);
})();
</script>
</body>
</html>
